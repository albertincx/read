{"version":3,"sources":["App.js","modules/ReactReader/style.js","modules/ReactReader/ReactReader.js","index.js","Components.js","modules/EpubView/style.js","modules/EpubView/EpubView.js"],"names":["storage","global","localStorage","DEMO_URL","GlobalStyle","createGlobalStyle","TextDecoder","TextEncoder","apiprocread_cache","getItem","App","props","toggleFullscreen","setState","fullscreen","state","setTimeout","document","createEvent","initUIEvent","onLocationChanged","location","setItem","onToggleFontSize","nextState","largeText","rendition","themes","fontSize","getRendition","handleChangeFile","event","results","a","length","e","file","type","alert","localFile","target","result","localforage","then","value","catch","err","console","log","localName","name","this","as","onChange","url","Array","isArray","title","locationChanged","onClick","Component","reactReaderStyles","container","overflow","height","readerArea","position","zIndex","width","backgroundColor","transition","containerExpanded","transform","titleArea","top","left","right","textAlign","color","reader","bottom","swipeWrapper","prev","next","arrow","outline","border","background","marginTop","padding","fontFamily","cursor","userSelect","appearance","fontWeight","arrowHover","tocBackground","tocArea","overflowY","WebkitOverflowScrolling","tocAreaButton","display","borderBottom","boxSizing","tocButton","borderRadius","tocButtonExpanded","tocButtonBar","margin","tocButtonBarTop","tocButtonBottom","loadingView","margintop","Swipeable","children","handlers","useSwipeable","TocItem","setLocation","href","label","styles","style","PureComponent","ReactReader","toggleToc","expandedToc","readerRef","current","nextPage","prevPage","onTocChange","toc","tocChanged","loc","React","createRef","map","item","i","key","Object","assign","showToc","swipeable","renderTocToggle","onSwipedRight","onSwipedLeft","trackMouse","EpubView","ref","renderToc","defaultProps","defaultStyles","render","getElementById","Container","styled","div","ReaderContainer","Bar","header","breakpoint","ButtonWrapper","Button","img","button","GenericButton","FontSizeButton","epubViewStyles","viewHolder","view","ePub","Epub","onLocationChange","newLocation","start","handleKeyPress","isLoaded","viewerRef","book","initBook","addEventListener","epubInitOptions","destroy","loaded","navigation","initReader","removeEventListener","nextProps","prevProps","epubOptions","node","renderTo","contained","registerEvents","handleTextSelected","on","renderBook"],"mappings":"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","file":"static/js/main.88746f3b.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport localforage from \"localforage\";\nimport { createGlobalStyle } from \"styled-components\";\nimport FileReaderInput from \"react-file-reader-input\";\nimport { ReactReader } from \"./modules\";\nimport {\n  Container,\n  ReaderContainer,\n  Bar,\n  LogoWrapper,\n  Logo,\n  GenericButton,\n  CloseIcon,\n  FontSizeButton,\n  ButtonWrapper\n} from \"./Components\";\n\nconst storage = global.localStorage || null;\n\nconst DEMO_URL =\n  \"/react-reader/files/alice.epub\";\nconst DEMO_NAME = \"Alice in wonderland\";\n\nconst GlobalStyle = createGlobalStyle`\n  * {\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen-Sans, Ubuntu, Cantarell, \"Helvetica Neue\", sans-serif;\n    margin: 0;\n    padding: 0;\n    color: inherit;\n    font-size: inherit;\n    font-weight: 300;\n    line-height: 1.4;\n    word-break: break-word;\n  }\n  html {\n    font-size: 62.5%;\n  }\n  body {\n    margin: 0;\n    padding: 0;\n    min-height: 100vh;\n    font-size: 1.8rem;\n    background: #333;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    color: #fff;\n  }\n`;\nfunction str2ab(str) {\n  var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char\n  var bufView = new Uint16Array(buf);\n  for (var i=0, strLen=str.length; i<strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\nfunction decodeUtf8(arrayBuffer) {\n  var result = \"\";\n  var i = 0;\n  var c = 0;\n  var c3 = 0;\n  var c2 = 0;\n  console.log(arrayBuffer)\n  console.log(arrayBuffer[0])\n  console.log(arrayBuffer[1])\n  var data = new Uint8Array(arrayBuffer);\n\n  // If we have a BOM skip it\n  if (data.length >= 3 && data[0] === 0xef && data[1] === 0xbb && data[2] === 0xbf) {\n    i = 3;\n  }\n\n  while (i < data.length) {\n    c = data[i];\n\n    if (c < 128) {\n      result += String.fromCharCode(c);\n      i++;\n    } else if (c > 191 && c < 224) {\n      if( i+1 >= data.length ) {\n        throw \"UTF-8 Decode failed. Two byte character was truncated.\";\n      }\n      c2 = data[i+1];\n      result += String.fromCharCode( ((c&31)<<6) | (c2&63) );\n      i += 2;\n    } else {\n      if (i+2 >= data.length) {\n        throw \"UTF-8 Decode failed. Multi byte character was truncated.\";\n      }\n      c2 = data[i+1];\n      c3 = data[i+2];\n      result += String.fromCharCode( ((c&15)<<12) | ((c2&63)<<6) | (c3&63) );\n      i += 3;\n    }\n  }\n  return result;\n}\nvar decoder = new TextDecoder(\"utf-8\");\nvar dencoder = new TextEncoder();\nfunction ab2str2(buf) {\n  return decoder.decode(buf);\n}\nfunction ab2str(buf) {\n  return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\nfunction str2ab2s(str) {\n  var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char\n  var bufView = new Uint16Array(buf);\n  for (var i=0, strLen=str.length; i < strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\nfunction str2ab11(str){\n  var buffer = new Uint16Array(str.length);\n\n  for(var idx = 0, len = str.length; idx < len; ++idx){\n    buffer[idx] = str.charCodeAt(idx);\n  }\n\n  return buffer;\n}\nlet apiprocread_cache = [];\nif (localStorage.getItem('apiprocread_cache')) {\n  /*let cache = localStorage.getItem('apiprocread_cache');\n  // cache = str2ab(cache)\n  console.log('cache',cache);\n  if (cache && cache !== null) {\n    // let apiprocread_cache1 =  dencoder.encode(cache).buffer;\n    let apiprocread_cache1 =  str2ab(cache);\n    console.log('apiprocread_cache1',apiprocread_cache1);\n\n    if(apiprocread_cache1){\n      apiprocread_cache = apiprocread_cache1\n    }\n    console.log('apiprocread_cache',apiprocread_cache);\n    // apiprocread_cache = JSON.parse(cache);\n  }*/\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      fullscreen: false,\n      location:\n        storage && storage.getItem(\"epub-location\")\n          ? storage.getItem(\"epub-location\")\n          : 2,\n      localFile: apiprocread_cache || null,\n      localName: null,\n      largeText: false\n    };\n    this.rendition = null;\n  }\n\n  componentDidMount() {\n    localforage.getItem('apiprocread_cache').then((value) => {\n      // This code runs once the value has been loaded\n      // from the offline store.\n      console.log(value);\n      this.setState({localFile: value});\n    }).catch(function(err) {\n      // This code runs if there were any errors\n      console.log(err);\n    });\n  }\n\n  toggleFullscreen = () => {\n    this.setState(\n      {\n        fullscreen: !this.state.fullscreen\n      },\n      () => {\n        setTimeout(() => {\n          const evt = document.createEvent(\"UIEvents\");\n          evt.initUIEvent(\"resize\", true, false, global, 0);\n        }, 1000);\n      }\n    );\n  };\n\n  onLocationChanged = location => {\n    this.setState(\n      {\n        location\n      },\n      () => {\n        storage && storage.setItem(\"epub-location\", location);\n      }\n    );\n  };\n\n  onToggleFontSize = () => {\n    const nextState = !this.state.largeText;\n    this.setState(\n      {\n        largeText: nextState\n      },\n      () => {\n        this.rendition.themes.fontSize(nextState ? \"140%\" : \"100%\");\n      }\n    );\n  };\n\n  getRendition = rendition => {\n    // Set inital font-size, and add a pointer to rendition for later updates\n    const { largeText } = this.state;\n    this.rendition = rendition;\n    rendition.themes.fontSize(largeText ? \"140%\" : \"100%\");\n  };\n  handleChangeFile = async (event, results) => {\n    if (results.length > 0) {\n      const [e, file] = results[0];\n      if (file.type !== \"application/epub+zip\") {\n        return alert(\"Unsupported type\");\n      }\n      const localFile = e.target.result\n      await localforage.setItem('apiprocread_cache', localFile).then(function (value) {\n        // Do other things once the value has been saved.\n        // console.log(value);\n      }).catch(function(err) {\n        // This code runs if there were any errors\n        console.log(err);\n      });\n      this.setState({\n        localFile: localFile,\n        localName: file.name,\n        location: null\n      });\n    }\n  };\n  render() {\n\n    const { fullscreen, location, localFile, localName } = this.state;\n\n    console.log(localFile || DEMO_URL);\n    /*if (!localStorage.getItem('apiprocread_cache') && localFile) {\n      if(Array.isArray(localFile) && localFile.length === 0){\n        //\n      } else {\n        let str = decodeUtf8(localFile);\n        if (str) localStorage.setItem('apiprocread_cache', str)\n      }\n    }*/\n    return (\n      <Container>\n        <GlobalStyle />\n        <Bar>\n          <ButtonWrapper>\n            <FileReaderInput as=\"buffer\" onChange={this.handleChangeFile}>\n              <GenericButton>Upload local epub</GenericButton>\n            </FileReaderInput>\n            <FileReaderInput as=\"buffer\" onChange={this.handleChangeFile}>\n              <GenericButton>Upload local epub</GenericButton>\n            </FileReaderInput>\n          </ButtonWrapper>\n        </Bar>\n        <ReaderContainer fullscreen={fullscreen}>\n          <ReactReader\n            url={!Array.isArray(localFile) && localFile ? localFile : null ||\n            DEMO_URL}\n            title={localName || DEMO_NAME}\n            location={location}\n            locationChanged={this.onLocationChanged}\n            getRendition={this.getRendition}\n          />\n          <FontSizeButton onClick={this.onToggleFontSize}>\n            Toggle font-size\n          </FontSizeButton>\n        </ReaderContainer>\n      </Container>\n    );\n  }\n}\n\nexport default App;\n","const reactReaderStyles = {\n  container: {\n    overflow: \"hidden\",\n    height: \"100%\"\n  },\n  readerArea: {\n    position: \"relative\",\n    zIndex: 1,\n    height: \"100%\",\n    width: \"100%\",\n    backgroundColor: \"#fff\",\n    transition: \"all .3s ease\"\n  },\n  containerExpanded: {\n    transform: \"translateX(256px)\"\n  },\n  titleArea: {\n    position: \"absolute\",\n    top: 20,\n    left: 50,\n    right: 50,\n    textAlign: \"center\",\n    color: \"#999\"\n  },\n  reader: {\n    position: \"absolute\",\n    top: 50,\n    left: 50,\n    bottom: 20,\n    right: 50\n  },\n  swipeWrapper: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 200\n  },\n  prev: {\n    left: 1\n  },\n  next: {\n    right: 1\n  },\n  arrow: {\n    outline: \"none\",\n    border: \"none\",\n    background: \"none\",\n    position: \"absolute\",\n    top: \"50%\",\n    marginTop: -32,\n    fontSize: 64,\n    padding: \"0 10px\",\n    color: \"#E2E2E2\",\n    fontFamily: \"arial, sans-serif\",\n    cursor: \"pointer\",\n    userSelect: \"none\",\n    appearance: \"none\",\n    fontWeight: \"normal\"\n  },\n  arrowHover: {\n    color: \"#777\"\n  },\n  tocBackground: {\n    position: \"absolute\",\n    left: 256,\n    top: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 1\n  },\n  tocArea: {\n    position: \"absolute\",\n    left: 0,\n    top: 0,\n    bottom: 0,\n    zIndex: 0,\n    width: 256,\n    overflowY: \"auto\",\n    WebkitOverflowScrolling: \"touch\",\n    background: \"#f2f2f2\",\n    padding: \"10px 0\"\n  },\n  tocAreaButton: {\n    userSelect: \"none\",\n    appearance: \"none\",\n    background: \"none\",\n    border: \"none\",\n    display: \"block\",\n    fontFamily: \"sans-serif\",\n    width: \"100%\",\n    fontSize: \".9em\",\n    textAlign: \"left\",\n    padding: \".9em 1em\",\n    borderBottom: \"1px solid #ddd\",\n    color: \"#aaa\",\n    boxSizing: \"border-box\",\n    outline: \"none\",\n    cursor: \"pointer\"\n  },\n  tocButton: {\n    background: \"none\",\n    border: \"none\",\n    width: 32,\n    height: 32,\n    position: \"absolute\",\n    top: 10,\n    left: 10,\n    borderRadius: 2,\n    outline: \"none\",\n    cursor: \"pointer\"\n  },\n  tocButtonExpanded: {\n    background: \"#f2f2f2\"\n  },\n  tocButtonBar: {\n    position: \"absolute\",\n    width: \"60%\",\n    background: \"#ccc\",\n    height: 2,\n    left: \"50%\",\n    margin: \"-1px -30%\",\n    top: \"50%\",\n    transition: \"all .5s ease\"\n  },\n  tocButtonBarTop: {\n    top: \"35%\"\n  },\n  tocButtonBottom: {\n    top: \"66%\"\n  },\n  loadingView: {\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"10%\",\n    right: \"10%\",\n    color: \"#ccc\",\n    textAlign: \"center\",\n    margintop: \"-.5em\"\n  }\n};\n\nexport default reactReaderStyles\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useSwipeable } from \"react-swipeable\";\nimport { EpubView } from \"..\";\nimport defaultStyles from \"./style\";\n\nconst Swipeable = ({children, ...props}) => {\n  const handlers = useSwipeable(props);\n  return (<div { ...handlers }>{children}</div>);\n}\n\nclass TocItem extends PureComponent {\n  setLocation = () => {\n    this.props.setLocation(this.props.href);\n  };\n  render() {\n    const { label, styles } = this.props;\n    return (\n      <button onClick={this.setLocation} style={styles}>\n        {label}\n      </button>\n    );\n  }\n}\n\nTocItem.propTypes = {\n  label: PropTypes.string,\n  href: PropTypes.string,\n  setLocation: PropTypes.func,\n  styles: PropTypes.object\n};\n\nclass ReactReader extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.readerRef = React.createRef();\n    this.state = {\n      expandedToc: false,\n      toc: false\n    };\n  }\n  toggleToc = () => {\n    this.setState({\n      expandedToc: !this.state.expandedToc\n    });\n  };\n\n  next = () => {\n    const node = this.readerRef.current;\n    node.nextPage();\n  };\n\n  prev = () => {\n    const node = this.readerRef.current;\n    node.prevPage();\n  };\n\n  onTocChange = toc => {\n    const { tocChanged } = this.props;\n    this.setState(\n      {\n        toc: toc\n      },\n      () => tocChanged && tocChanged(toc)\n    );\n  };\n\n  renderToc() {\n    const { toc, expandedToc } = this.state;\n    const { styles } = this.props;\n    return (\n      <div>\n        <div style={styles.tocArea}>\n          <div style={styles.toc}>\n            {toc.map((item, i) => (\n              <TocItem\n                {...item}\n                key={i}\n                setLocation={this.setLocation}\n                styles={styles.tocAreaButton}\n              />\n            ))}\n          </div>\n        </div>\n        {expandedToc && (\n          <div style={styles.tocBackground} onClick={this.toggleToc} />\n        )}\n      </div>\n    );\n  }\n\n  setLocation = loc => {\n    const { locationChanged } = this.props;\n    this.setState(\n      {\n        expandedToc: false\n      },\n      () => locationChanged && locationChanged(loc)\n    );\n  };\n\n  renderTocToggle() {\n    const { expandedToc } = this.state;\n    const { styles } = this.props;\n    return (\n      <button\n        style={Object.assign(\n          {},\n          styles.tocButton,\n          expandedToc ? styles.tocButtonExpanded : {}\n        )}\n        onClick={this.toggleToc}\n      >\n        <span\n          style={Object.assign({}, styles.tocButtonBar, styles.tocButtonBarTop)}\n        />\n        <span\n          style={Object.assign({}, styles.tocButtonBar, styles.tocButtonBottom)}\n        />\n      </button>\n    );\n  }\n\n  render() {\n    const {\n      title,\n      showToc,\n      loadingView,\n      styles,\n      locationChanged,\n      swipeable,\n      ...props\n    } = this.props;\n    const { toc, expandedToc } = this.state;\n    return (\n      <div style={styles.container}>\n        <div\n          style={Object.assign(\n            {},\n            styles.readerArea,\n            expandedToc ? styles.containerExpanded : {}\n          )}\n        >\n          {showToc && this.renderTocToggle()}\n          <div style={styles.titleArea}>{title}</div>\n          <Swipeable\n            onSwipedRight={this.prev}\n            onSwipedLeft={this.next}\n            trackMouse\n          >\n            <div style={styles.reader}>\n              <EpubView\n                ref={this.readerRef}\n                loadingView={loadingView}\n                {...props}\n                tocChanged={this.onTocChange}\n                locationChanged={locationChanged}\n              />\n              {swipeable && <div style={styles.swipeWrapper} />}\n            </div>\n          </Swipeable>\n          <button\n            style={Object.assign({}, styles.arrow, styles.prev)}\n            onClick={this.prev}\n          >\n            ‹\n          </button>\n          <button\n            style={Object.assign({}, styles.arrow, styles.next)}\n            onClick={this.next}\n          >\n            ›\n          </button>\n        </div>\n        {showToc && toc && this.renderToc()}\n      </div>\n    );\n  }\n}\n\nReactReader.defaultProps = {\n  loadingView: <div style={defaultStyles.loadingView}>Loading…</div>,\n  locationChanged: null,\n  tocChanged: null,\n  showToc: true,\n  styles: defaultStyles\n};\n\nReactReader.propTypes = {\n  title: PropTypes.string,\n  loadingView: PropTypes.element,\n  showToc: PropTypes.bool,\n  locationChanged: PropTypes.func,\n  tocChanged: PropTypes.func,\n  styles: PropTypes.object,\n  swipeable: PropTypes.bool\n};\n\nexport default ReactReader;\n","import React from \"react\";\nimport { render } from \"react-dom\";\nimport App from \"./App\";\n\nrender(<App />, document.getElementById(\"root\"));\n","import styled from \"styled-components\";\nimport breakpoint from \"styled-components-breakpoint\";\n\nexport const Container = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  min-height: 100vh;\n  background: linear-gradient(to bottom, #f2f2f2 0%, #333 100%);\n  overflow: hidden;\n`;\nexport const ReaderContainer = styled.div`\n  font-size: 16px;\n  position: absolute;\n  top: ${props => (props.fullscreen ? 0 : 135)}px;\n  left: ${props => (props.fullscreen ? 0 : 1)}rem;\n  right: ${props => (props.fullscreen ? 0 : 1)}rem;\n  bottom: ${props => (props.fullscreen ? 0 : 1)}rem;\n  transition: all 0.6s ease;\n  ${props => !props.fullscreen && \"0 0 5px rgba(0,0,0,.3);\"};\n`;\nexport const Bar = styled.header`\n  position: absolute;\n  top: 10px;\n  left: 20px;\n  right: 20px;\n\n  ${breakpoint(\"tablet\")`\n    display: flex;\n    align-items: flex-end;\n  `};\n`;\nexport const ButtonWrapper = styled.div`\n  ${breakpoint(\"mobile\")`\n    display: flex;\n    justify-content: center;\n    align-items: baseline;\n    padding-top: 0.5rem;\n  `};\n`;\nexport const LogoWrapper = styled.a`\n  ${breakpoint(\"tablet\")`\n    margin-right: auto;\n  `};\n`;\nexport const Logo = styled.img`\n  width: 250px;\n  height: auto;\n  display: block;\n  margin: 0 auto 0px;\n  ${breakpoint(\"tablet\")`\n    width: 330px;\n    height: 104px;\n    display: inline-block;\n    margin-left: 2px;\n  `};\n`;\nconst Button = styled.button`\n  font-family: inherit;\n  font-size: inherit;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  user-select: none;\n  appearance: none;\n  background: none;\n`;\nexport const GenericButton = styled(Button)`\n  color: #808080;\n  font-size: 12px;\n  display: inline-block;\n  margin-left: 1rem;\n  ${breakpoint(\"tablet\")`\n    font-size: 16px;\n    \n  `};\n`;\nexport const CloseIcon = styled.i`\n  vertical-align: middle;\n  display: inline-block;\n  width: 2rem;\n  height: 2rem;\n  background: #666;\n  margin-left: 5px;\n  border-radius: 50%;\n  position: relative;\n  transform: rotate(45deg);\n  &:before,\n  &:after {\n    content: \"\";\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 60%;\n    height: 2px;\n    background: #fff;\n    margin-left: -30%;\n    margin-top: -1px;\n    border-radius: 1px;\n  }\n  &:after {\n    transform: rotate(-90deg);\n  }\n`;\nexport const FontSizeButton = styled(Button)`\n  position: fixed;\n  bottom: 1.5rem;\n  right: 1.5rem;\n  z-index: 10;\n  background: #eee;\n  border-radius: 2px;\n  padding: 0.5rem;\n`;\n","const epubViewStyles = {\n  viewHolder: {\n    position: \"relative\",\n    height: \"100%\",\n    width: \"100%\"\n  },\n  view: {\n    height: \"100%\"\n  }\n};\n\nexport default epubViewStyles\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Epub from \"epubjs/lib/index\";\nimport defaultStyles from \"./style\";\n\nglobal.ePub = Epub; // Fix for v3 branch of epub.js -> needs ePub to by a global var\n\nclass EpubView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoaded: false,\n      toc: []\n    };\n    this.viewerRef = React.createRef();\n    this.location = props.location;\n    this.book = this.rendition = this.prevPage = this.nextPage = null;\n  }\n\n  componentDidMount() {\n    this.initBook(true);\n    document.addEventListener(\"keyup\", this.handleKeyPress, false);\n  }\n\n  initBook() {\n    const { url, tocChanged, epubInitOptions } = this.props;\n    if (this.book) {\n      this.book.destroy();\n    }\n    this.book = new Epub(url, epubInitOptions);\n    this.book.loaded.navigation.then(({ toc }) => {\n      this.setState(\n        {\n          isLoaded: true,\n          toc: toc\n        },\n        () => {\n          tocChanged && tocChanged(toc);\n          this.initReader();\n        }\n      );\n    });\n  }\n\n  componentWillUnmount() {\n    this.book = this.rendition = this.prevPage = this.nextPage = null;\n    document.removeEventListener(\"keyup\", this.handleKeyPress, false);\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return (\n      !this.state.isLoaded ||\n      nextProps.location !== this.props.location ||\n      nextProps.location !== this.props.location\n    );\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.location !== this.props.location &&\n      this.location !== this.props.location\n    ) {\n      this.rendition.display(this.props.location);\n    }\n    if (prevProps.url !== this.props.url) {\n      this.initBook();\n    }\n  }\n\n  initReader() {\n    const { toc } = this.state;\n    const { location, epubOptions, getRendition } = this.props;\n    const node = this.viewerRef.current;\n    this.rendition = this.book.renderTo(node, {\n      contained: true,\n      width: \"100%\",\n      height: \"100%\",\n      ...epubOptions\n    });\n\n    this.prevPage = () => {\n      this.rendition.prev();\n    };\n    this.nextPage = () => {\n      this.rendition.next();\n    };\n    this.registerEvents();\n    getRendition && getRendition(this.rendition);\n\n    if(typeof location === \"string\" || typeof location === \"number\") {\n      this.rendition.display(location);\n    } else if(toc.length > 0 && toc[0].href) {\n      this.rendition.display(toc[0].href);\n    } else {\n      this.rendition.display();\n    }\n  }\n\n  registerEvents() {\n    const { handleKeyPress, handleTextSelected } = this.props;\n    this.rendition.on(\"locationChanged\", this.onLocationChange);\n    this.rendition.on(\"keyup\", handleKeyPress || this.handleKeyPress);\n    if (handleTextSelected) {\n      this.rendition.on('selected', handleTextSelected);\n    }\n  }\n\n  onLocationChange = loc => {\n    const { location, locationChanged } = this.props;\n    const newLocation = loc && loc.start;\n    if (location !== newLocation) {\n      this.location = newLocation;\n      locationChanged && locationChanged(newLocation);\n    }\n  };\n\n  renderBook() {\n    const { styles } = this.props;\n    return <div ref={this.viewerRef} style={styles.view} />;\n  }\n\n  handleKeyPress = ({ key }) => {\n    key && key === \"ArrowRight\" && this.nextPage();\n    key && key === \"ArrowLeft\" && this.prevPage();\n  };\n\n  render() {\n    const { isLoaded } = this.state;\n    const { loadingView, styles } = this.props;\n    return (\n      <div style={styles.viewHolder}>\n        {(isLoaded && this.renderBook()) || loadingView}\n      </div>\n    );\n  }\n}\n\nEpubView.defaultProps = {\n  loadingView: null,\n  locationChanged: null,\n  tocChanged: null,\n  styles: defaultStyles,\n  epubOptions: {},\n  epubInitOptions: {}\n};\n\nEpubView.propTypes = {\n  url: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.instanceOf(ArrayBuffer)\n  ]),\n  loadingView: PropTypes.element,\n  location: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  locationChanged: PropTypes.func,\n  tocChanged: PropTypes.func,\n  styles: PropTypes.object,\n  epubInitOptions: PropTypes.object,\n  epubOptions: PropTypes.object,\n  getRendition: PropTypes.func,\n  handleKeyPress: PropTypes.func,\n  handleTextSelected: PropTypes.func\n};\n\nexport default EpubView;\n"],"sourceRoot":""}